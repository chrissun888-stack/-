<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>樣書 / 業務快速紀錄</title>

<style>
body{
  margin:0;
  font-family: system-ui, -apple-system, "Noto Sans TC", "Microsoft JhengHei", sans-serif;
  background: linear-gradient(180deg,#F5F8FF,#EEF3FF);
  color:#1F2A44;
}
.wrap{max-width:960px;margin:auto;padding:20px;}
.card{
  background:#fff;
  border-radius:16px;
  box-shadow:0 18px 40px rgba(0,0,0,.1);
  padding:20px;
}
.grid{display:grid;grid-template-columns:1fr;gap:14px;}
@media(min-width:760px){.grid{grid-template-columns:1fr 1fr}.span2{grid-column:1/-1}}
label{font-size:13px;color:#6B7AA8;margin-bottom:6px;display:block}
input,select,textarea{
  width:100%;padding:12px;border-radius:12px;border:1px solid #D6DEFF;font-size:15px
}
textarea{min-height:110px}
button{
  padding:12px;border-radius:12px;border:none;font-size:15px;cursor:pointer
}
.primary{background:#4F7CFF;color:#fff}
.actions{display:flex;gap:12px;margin-top:18px}
.status{margin-top:12px;font-size:13px;color:#6B7AA8}

/* tags */
.tagWrap{display:flex;flex-wrap:wrap;gap:8px}
.tag{
  padding:8px 12px;
  border-radius:999px;
  background:#EEF3FF;
  border:1px solid #C9D6FF;
  cursor:pointer;
}
.tag.active{background:#4F7CFF;color:#fff;border-color:#4F7CFF}
.tag.other{border-style:dashed}
</style>
</head>

<body>
<div class="wrap">
<h2>樣書 / 業務快速紀錄</h2>

<div class="card">
<div class="grid">

<div>
<label>客戶名稱</label>
<input id="clientName">
</div>

<div>
<label>聯絡人</label>
<input id="contactName">
</div>

<div>
<label>職稱</label>
<select id="title">
<option value="">—</option>
<option>主任</option>
<option>老師</option>
<option>負責人/老闆</option>
<option>行政</option>
<option>採購</option>
</select>
</div>

<div>
<label>電話</label>
<input id="phone">
</div>

<div>
<label>區域</label>
<select id="area">
<option value="">—</option>
<option>北區</option>
<option>中區</option>
<option>南區</option>
<option>全區</option>
</select>
</div>

<div>
<label>紀錄人</label>
<select id="user">
<option value="">—</option>
<option>全區-Ken</option>
<option>北區-Chris</option>
<option>中區-Tania</option>
<option>南區-Sonia</option>
</select>
</div>

<div class="span2">
<label>教材名稱（自動同步）</label>
<div id="productTags" class="tagWrap"></div>
</div>

<div id="otherWrap" class="span2" style="display:none">
<label>其他教材</label>
<input id="otherProduct">
</div>

<div class="span2">
<label>備註</label>
<textarea id="note"></textarea>
</div>

</div>

<div class="actions">
<button class="primary" onclick="save()">儲存</button>
<button onclick="resetForm()">清空</button>
</div>

<div class="status" id="status"></div>
</div>
</div>

<script>
const WEB_APP_URL = "PASTE_YOUR_WEB_APP_URL_HERE";
const TOKEN = "CHANGE_ME_TO_A_LONG_RANDOM_TOKEN";
const selected = new Set();

async function loadProducts(){
  const res = await fetch(WEB_APP_URL+"?action=products");
  const list = await res.json();
  const wrap = document.getElementById("productTags");
  wrap.innerHTML="";

  list.forEach(name=>{
    const s=document.createElement("span");
    s.className="tag";
    s.textContent=name;
    s.onclick=()=>{
      s.classList.toggle("active");
      s.classList.contains("active")?selected.add(name):selected.delete(name);
    };
    wrap.appendChild(s);
  });

  const other=document.createElement("span");
  other.className="tag other";
  other.textContent="其他";
  other.onclick=()=>{
    other.classList.toggle("active");
    document.getElementById("otherWrap").style.display=
      other.classList.contains("active")?"block":"none";
  };
  wrap.appendChild(other);
}

function getProducts(){
  let arr=[...selected];
  const other=document.getElementById("otherProduct").value;
  if(other) other.split(",").map(s=>s.trim()).forEach(x=>arr.push(x));
  return arr.join(", ");
}

async function save(){
  const payload={
    token:TOKEN,
    clientName:clientName.value,
    contactName:contactName.value,
    title:title.value,
    phone:phone.value,
    area:area.value,
    product:getProducts(),
    note:note.value,
    user:user.value
  };

  status.textContent="儲存中…";

  const r=await fetch(WEB_APP_URL,{method:"POST",body:JSON.stringify(payload)});
  const d=await r.json();
  status.textContent=d.ok?"已儲存":"儲存失敗";
}

function resetForm(){
  document.querySelectorAll("input,textarea,select").forEach(e=>e.value="");
  document.querySelectorAll(".tag").forEach(t=>t.classList.remove("active"));
  selected.clear();
  otherWrap.style.display="none";
  status.textContent="";
}

loadProducts();
</script>
</body>
</html>
